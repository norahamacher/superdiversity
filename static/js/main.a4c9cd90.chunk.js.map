{"version":3,"sources":["images/bivariate_scheme1.png","images/color_sequential.png","MapFunctions.js","Menu.js","Helpers.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","MapFunctions","m_initiated","map","this","center","props","city","m_tilesets","console","log","mapboxgl","accessToken","Map","container","style","zoom","on","addSource","type","data","cluster","once","ev","setLayoutProperty","year","i","length","sourceName","url","id","addLayer","source","layout","visibility","sourcelayer","paint","heightParam","getCanvas","cursor","tooltipContainer","document","createElement","init","prevProps","s","g_min","boundingValuesHeight","g_max","setPaintProperty","colorChanged","getSource","setData","className","Component","m_menu_structure","state","subItem","width","height","color","bivariate","activeWidth","activeHeight","activeColor","activeBivariate","changeWidth","event","target","value","setState","callbackF","changeHeight","changeColor","changeBivariate1","arr","changeBivariate2","toggleActive","y","toggleAttribute","attr","prevState","handleChange","name","years","onChange","key","item","onClick","indices","children","title","app","def","callback","active","callback1","callback2","currentCity","currentYear","initWidth","initHeight","AttributeSection","child","getHighestValue","parameter","val","highest","features","parseFloat","properties","getLowestValue","lowest","getIndicesForCity","getNewRangeValue","x","oldMin","oldMax","newMin","newMax","isNaN","undefined","result","App","m_datasets","centerData96Auckland","centerData13Auckland","centerData06Melb","centerData11Melb","centerData16Melb","centerData2001Syd","centerData2006Syd","centerData2011Syd","centerData2016Syd","centerData96Vanc","centerData06Vanc","centerData16Vanc","m_biVariatecolors","m_colorsSequential","m_selectorStructure","m_boundingValuesColor","heightParameter","widthParameter","colorParameter","bivariateParameter1","bivariateParameter2","showBivariate","showColor","boundingValuesWidth","boundingValuesBivariate1","boundingValuesBivariate2","prepDatasets","dataset","newGeometry","j","turf","geometry","coordinates","steps","centerCircle","propertyKeys","Object","keys","indexOf","renameKey","object","newKey","clonedObj","clone","targetKey","getBoundingValues","highestValueArray","highestValues","lowestValues","menuCallback","label","content","updateColors","high","index","low","helper","param","bounds","a","b","test","Array","apply","Math","floor","src","bivariateImage","alt","colorImage","widthParam","bivariateParam1","bivariateParam2","obj","assign","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.a4c9cd90.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/bivariate_scheme1.a9095b3d.png\";","module.exports = \"data:image/png;base64,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\"","import mapboxgl from 'mapbox-gl'\r\nimport React, { Component } from 'react';\r\n\r\n//import geojson from 'geojson'\r\nexport default class MapFunctions extends Component {\r\n\r\n    // set to 2017 initially despite play preview or you get a bug when using the type dropdown\r\n    m_initiated = false\r\n    map = null\r\n    tooltipContainer\r\n    popup\r\n\r\n    m_tilesets\r\n\r\n     init() {\r\n        if (!this.m_initiated) {\r\n\r\n            var center = []\r\n            switch(this.props.city){\r\n                case \"Vancouver\":\r\n                    this.m_tilesets = [\r\n                        {\"year\":1996, \"id\": \"mapbox://norahama.1jokwrkx\", \"sourcelayer\" : \"Vancouver2006-2eyjv2\", \"sourceName\":\"source1996\"},\r\n                        {\"year\":2006, \"id\":\"mapbox://norahama.1jokwrkx\", \"sourcelayer\" : \"Vancouver2006-2eyjv2\", \"sourceName\":\"source2006\"},\r\n                        {\"year\":2016, \"id\": \"mapbox://norahama.2pk73wv6\", \"sourcelayer\" : \"Vancouver2016-1nzu7l\", \"sourceName\":\"source2016\"}\r\n                    ]\r\n                    \r\n                    center = [-122.576, 49.028]\r\n                    break;\r\n                case \"Melbourne\":\r\n                    this.m_tilesets = [\r\n                        // \"2001\":{\"id\": \"mapbox:/norahama.anl71j5p\", \"sourcelayer\" : \"Melbourne2001-23s20v\"},\r\n                         {\"year\":2006,\"id\": \"mapbox://norahama.bm41q2of\", \"sourcelayer\" : \"Melbourne2006-6b3o6h\", \"sourceName\" : \"source2006\"},\r\n                         {\"year\":2011,\"id\": \"mapbox://norahama.dzjhyft8\", \"sourcelayer\" : \"Melbourne2011-csnnwo\", \"sourceName\" : \"source2011\"},\r\n                         {\"year\":2016,\"id\":  \"mapbox://norahama.cc4vdfad\", \"sourcelayer\" : \"Melbourne2016-47i90b\", \"sourceName\" :\"source2016\"}\r\n                ]\r\n                     center =  [144.96,-37.84]\r\n                    break;\r\n                case \"Auckland\":\r\n                   this.m_tilesets = [\r\n                        {\"year\":1996,\"id\": \"mapbox://norahama.deq4a9rw\", \"sourcelayer\" : \"AucklandShape-19n187\", \"sourceName\" : \"source1996\"},\r\n                        {\"year\":2013,\"id\": \"mapbox://norahama.deq4a9rw\", \"sourcelayer\" : \"AucklandShape-19n187\", \"sourceName\" : \"source2013\"}\r\n                \r\n                   ]\r\n                    center =  [174.76,-36.84]\r\n                    break;\r\n                case \"Sydney\":\r\n                    this.m_tilesets = [\r\n                        {\"year\":2001,\"id\": \"mapbox://norahama.8m5ctm9s\", \"sourcelayer\" : \"Sydney2001-2hwwxg\", \"sourceName\" : \"source2001\"},\r\n                        {\"year\":2006,\"id\":  \"mapbox://norahama.6tv4znv6\", \"sourcelayer\" : \"Sydney2006-6nogcm\", \"sourceName\" : \"source2006\"},\r\n                        {\"year\":2011,\"id\":  \"mapbox://norahama.dmybv4hi\", \"sourcelayer\" : \"Sydney2011-6m951w\", \"sourceName\" : \"source2011\"},\r\n                        {\"year\":2016,\"id\":  \"mapbox://norahama.darbn0un\", \"sourcelayer\" : \"Sydney2016-71t1cr\", \"sourceName\" : \"source2016\"}\r\n                    ]\r\n                    center =  [151.21, -33.87]\r\n                    break;\r\n                default:\r\n                    console.log(\"Error in map init city: \" + this.props.city)\r\n            }\r\n          //  console.log(centerData)\r\n            mapboxgl.accessToken = \"pk.eyJ1Ijoibm9yYWhhbWEiLCJhIjoiY2ptaGFsZDR5MThrczN1dDhtajc1cTFmMSJ9.VEUImGmfsM77LfjErYxDdQ\"\r\n            this.map = new mapboxgl.Map({\r\n                container: \"map\",\r\n                style: \"mapbox://styles/norahama/ckcoa4nbq00zr1imv7shjhzo1\",\r\n                zoom: [10],\r\n                center: center\r\n            })\r\n          \r\n            \r\n            this.map.on('load', () => {\r\n                // add source and layer for museums\r\n\r\n                this.map.addSource('centerData', {\r\n                    type: 'geojson',\r\n                    data: this.props.data,\r\n                    cluster: false\r\n                })\r\n                \r\n                var self = this\r\n                this.map.once('style.load', (ev) => {\r\n                    console.log(\"style Load\")\r\n                    this.map.setLayoutProperty(\"bars\" + this.props.year, 'visibility','visible')\r\n                })\r\n\r\n                for(var i = 0; i < this.m_tilesets.length; i++){\r\n                    this.map.addSource(this.m_tilesets[i].sourceName, {\r\n                        type:'vector',\r\n                        url: this.m_tilesets[i].id\r\n                    })\r\n\r\n                }\r\n             \r\n     /*           this.map.addLayer({\r\n                    id: 'vanc3d',\r\n                    type: 'fill-extrusion',\r\n                    source: 'vancouver2016',\r\n                    layout: {\r\n                        visibility: 'none'\r\n                    },\r\n                    'source-layer': this.m_tilesets[\"2016\"].sourcelayer,\r\n                    paint: {\r\n                        'fill-extrusion-height':\r\n                            [\r\n                                'match',\r\n                                ['get', 'CSDUID'],\r\n                                \"5915840\", 500,\r\n                                \"5915830\", 500,\r\n                                \"5915825\", 1800,\r\n                                \"5915816\", 200,\r\n                                \"5915813\", 4000,\r\n                                0\r\n                            ],\r\n                        'fill-extrusion-color': [\r\n                            'match',\r\n                            ['get', 'CSDUID'],\r\n                            \"5915840\", \"#d41111\",\r\n                            \"5915830\", \"#d41111\",\r\n                            \"5915825\", \"#d41111\",\r\n                            \"5915816\", \"#d41111\",\r\n                            \"5915813\", \"#d41111\",\r\n                            \"#888281\"\r\n                        ]\r\n                        ,\r\n                        \"fill-extrusion-opacity\": 0.7\r\n                    }\r\n                })*/\r\n           \r\n\r\n                for( i = 0; i < this.m_tilesets.length; i++){\r\n\r\n                    \r\n                    this.map.addLayer({\r\n                        id: 'fill'+ this.m_tilesets[i].year,\r\n                        type: 'fill',\r\n                        source: this.m_tilesets[i].sourceName,   \r\n                        layout: {\r\n                            // make layer visible by default\r\n                            visibility: 'none',\r\n                        },\r\n                        'source-layer': this.m_tilesets[i].sourcelayer,                    \r\n                        paint: {\r\n                            'fill-color': \r\n                                \"#888281\"\r\n                            ,\r\n                            'fill-outline-color': \"black\",\r\n                            \"fill-opacity\": 0.4\r\n                        }\r\n    \r\n                    });\r\n                    if(this.props.year == this.m_tilesets[i].year) {\r\n                        console.log(this.props.year)\r\n                        this.map.addLayer({\r\n                            id: 'bars' + this.m_tilesets[i].year,\r\n                            type: 'fill-extrusion',\r\n                            source: \"centerData\",\r\n                            layout: {\r\n                                // make layer visible by default\r\n                                visibility: 'visible'\r\n                            },\r\n                           // 'source-layer': this.m_tilesets[ this.props.year].sourcelayer,\r\n                            paint: {\r\n                                'fill-extrusion-color': ['get','color'],\r\n                                'fill-extrusion-height': [\"to-number\", ['get',this.props.heightParam]],\r\n                                'fill-extrusion-opacity': 0.7\r\n                            }\r\n                        })\r\n                    } else {\r\n                        this.map.addLayer({\r\n                            id: 'bars' + this.m_tilesets[i].year,\r\n                            type: 'fill-extrusion',\r\n                            source: \"centerData\",\r\n                            layout: {\r\n                            // make layer visible by default\r\n                                visibility: 'none'\r\n                            },\r\n                       // 'source-layer': this.m_tilesets[ this.props.year].sourcelayer,\r\n                            paint: {\r\n                                'fill-extrusion-color': ['get','color'],\r\n                                'fill-extrusion-height': [\"to-number\", ['get',this.props.heightParam]] ,\r\n                            'fill-extrusion-opacity': 0.7\r\n                            }\r\n                        })\r\n                    }\r\n\r\n                }\r\n\r\n            })\r\n            // Change the cursor style as a UI indicator.\r\n            this.map.getCanvas().style.cursor = 'pointer';\r\n            \r\n           \r\n            this.m_initiated = true;\r\n\r\n        }\r\n\r\n    }\r\n    componentDidMount() {\r\n        this.tooltipContainer = document.createElement('div');\r\n        if(this.props.data!==[]) {\r\n            console.log(\"MapComponent Got Data\")\r\n            this.init()\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if(this.props.data!==[]){\r\n            //console.log(this.props.data)\r\n            this.init()\r\n        }\r\n\r\n        if(this.props.year!==prevProps.year){\r\n            this.map.setLayoutProperty(\"bars\" + this.props.year, 'visibility','visible')\r\n            this.map.setLayoutProperty(\"bars\" + prevProps.year, 'visibility','none')\r\n        }\r\n        //city changed, load the correct sources and layers for the new city.\r\n        if(this.props.city!==prevProps.city){\r\n            this.m_initiated =false;\r\n            this.init()\r\n        }\r\n        //console.log(this.props.data)\r\n        if(this.props.heightParam !== prevProps.heightParam) {\r\n            \r\n            var s = this.props.heightParam\r\n            var g_min = this.props.boundingValuesHeight[0]\r\n            var g_max = this.props.boundingValuesHeight[1]\r\n            //var val = getHighestValue(this.props.data,this.props.heightParam)\r\n            this.map.setPaintProperty('bars' + this.props.year,'fill-extrusion-height',  [\"/\",[\"*\",[\"-\",[\"to-number\",['get',s]], g_min],    5000], [\"-\",g_max, g_min ]])\r\n           console.log(\",..\")\r\n         //  [\"/\",[\"*\",[\"-\",['get',this.props.heightParam], this.props.boundingValuesHeight[0]],5000],  [[\"-\"],[this.props.boundingValuesHeight[1],[this.props.boundingValuesHeight[0]]] ]]\r\n          \r\n        }\r\n\r\n\r\n        if(this.props.colorChanged !== prevProps.colorChanged){\r\n            this.map.getSource(\"centerData\").setData(this.props.data)\r\n          \r\n        }\r\n        \r\n    }\r\n\r\n     \r\n   \r\n    render() {\r\n        return (\r\n\r\n            <div  className=\"mapContainer\" id=\"map\" />\r\n\r\n        )\r\n    }\r\n\r\n    \r\n\r\n}\r\n\r\n\r\n/*\r\nThe data stays the same except for the radius of the polygon.\r\n\r\nThe thing that changes is the paint.\r\n\r\nHeight, color, possibly opacity, and radius can change based on different attributes.\r\n\r\nAs attributes change based on the input:\r\na) Normalise the data field\r\nb) map the data field to the chosesn attribute \r\n\r\n\r\n*/\r\n\r\n\r\n        /*       this.map.on('mouseenter', 'layer2016', function (e) {\r\n                    // Change the cursor style as a UI indicator.\r\n                    //    console.log(\"enter: \" + e.features[0].properties.site)\r\n                    if (message !== e.features[0].properties) {\r\n                        message = e.features[0].properties\r\n                 //           console.log(e.features[0])\r\n                        //  console.log(e.lngLat.wrap())\r\n                    }\r\n                    //      console.log(e)\r\n                    if (!onlyOnce) {\r\n\r\n\r\n\r\n                  //      self.randomiseData();\r\n                        var newgeoJson = []\r\n                        //get centers\r\n\r\n                     \r\n               \r\n               \r\n                        //create Polygon JSON from available data\r\n                       var newgeoJson = []\r\n                        var features = self.map.queryRenderedFeatures({ layers: ['layer2016'] })\r\n\r\n                  //      console.log(features)\r\n                        for (var i = 0; i < features.length; i++) {\r\n                            var poly = features[i].geometry.coordinates[0]\r\n                            var input = []\r\n                         //   console.log(poly)\r\n                            for (var j = 0; j < poly.length; j++) {\r\n                                \r\n                                input.push({ \"latitude\": poly[j][1], \"longitude\": poly[j][0] })\r\n                            } \r\n                          //  console.log(input)\r\n                      \r\n                            if(input.length > 1) {\r\n                             var center = geolib.getCenter(input)\r\n                          //   console.log(center)\r\n                             if(!isNaN(center.longitude) && !isNaN(center.latitude)){\r\n                           //  newgeoJson.push({ 'type': 'Feature', 'geometry': { \"type\":\"Point\",\"coordinates\":[center.longitude,center.latitude] }})\r\n                                var circlepoly = turf.circle([center.longitude,center.latitude], 0.3, { steps: 20 })\r\n                                newgeoJson.push({ 'type': 'Feature', 'geometry': circlepoly.geometry,'properties': { 'id':features[i].id, 'properties':features[i].properties, 'color':self.m_colors[Math.floor(Math.random() * Math.floor(7))],'height':  Math.floor(Math.random() * (20000 - 5000)) + 5000}})\r\n                             }\r\n                            }\r\n                \r\n                        }\r\n      \r\n                        var FinalJson = { \"type\": \"FeatureCollection\", \"features\": newgeoJson }\r\n                        console.log(JSON.stringify(FinalJson))  \r\n                        onlyOnce = true\r\n                    }\r\n                })\r\n                this.map.on('mousemove', 'vancCirc', function (e) {\r\n                    // Change the cursor style as a UI indicator.\r\n                    //    console.log(\"enter: \" + e.features[0].properties.site)\r\n                    if (message !== e.features[0].properties) {\r\n                        message = e.features[0].properties\r\n                        //       console.log(e.features[0].properties)\r\n                    }\r\n\r\n                })\r\n\r\n                this.map.on('mouseleave', 'vanc', function (e) {\r\n                    // Change the cursor style as a UI indicator.\r\n                    //    console.log(\"enter: \" + e.features[0].properties.site)\r\n                    console.log(\"out\")\r\n                    message = \"\"\r\n\r\n                })*/\r\n\r\n","import React, { Component } from 'react';\r\n\r\nexport default class MapFunctions extends Component {\r\n\r\n\r\n \r\n    \r\n  //menu structure with years and indices for each city. The values are fixed but their selection is dynamic.\r\n    m_menu_structure =  [ \r\n    {\"name\":\"Melbourne\",\r\n    \"years\": [2006,2011,2016],\r\n    \"indices\": [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-raw-normalized\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n        \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\"],\r\n    },\r\n   { \r\n    \"name\":\"Sydney\",\r\n    \"years\": [ 2001,2006,2011,2016],\r\n    \"indices\":  [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-raw-normalized\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n    \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\"],\r\n  },\r\n   { \r\n    \"name\": \"Vancouver\",\r\n    \"years\": [1996,2006,2016],\r\n    \"indices\" : [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n    \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\",\"Income-SE\",\"Ethnicity-raw-norm\",\"Immig-category-raw-SI\",\t\"Immig-category-index\"\t],\r\n  },\r\n  { \r\n    \"name\": \"Auckland\",\r\n    \"years\":[1996,2013],\r\n    \"indices\" : [\"Population\",\"Ethnicity-count\",\t\"Ethnicity-index\",\t\"Ethnicity-norm\",\t\"Ethnicity-norm-index\",\t\"Mobility-pct\",\t\"Mobility-index\",\t\"Generation-SI\",\t\"Generation-index\",\t\"Income-SI\",\t\"Income-index\",\r\n      \"Education-SI\",\t\"Education-index\"]\r\n  }]\r\n    state = {\r\n        subItem: {},\r\n        city: \"\",\r\n        year: 2006,\r\n        width: \"Ethnicity-index\",\r\n        height: \"Population\",\r\n        color: \"Generation-raw-SI\",\r\n        bivariate: [\"Ethnicity-index\",\"Income-index\"],\r\n        activeWidth: false,\r\n        activeHeight:true,\r\n        activeColor:true,\r\n        activeBivariate: false\r\n    }\r\n  render() {\r\n    return (\r\n        <div className=\"menu\">\r\n            <div className=\"citySection\">\r\n            <span>City: </span>\r\n                <select className=\"cityDropdown\" value={this.state.city} onChange={this.handleChange}>\r\n                    {this.m_menu_structure.map(\r\n                        (city, i) =>\r\n                         <option key={\"city\"+i} value={city.name}>{city.name}</option>\r\n                    )}\r\n                </select>\r\n            </div>\r\n\r\n            <div className=\"yearSection\">\r\n                <span>Year: </span>\r\n                <div className=\"yearbuttons\">\r\n                    {   this.state.subItem.years ? \r\n                            this.state.subItem.years.map(\r\n                                (item,i) =>\r\n                                    <div onClick={() => this.toggleActive(item)} className={`yearButton ${this.state.year==item? \"yearButton_active\": \"\"}`} key={\"yearButton\"+i}>{item} </div>\r\n                            \r\n                            )\r\n                        : \"Loading...\"\r\n                    }\r\n                </div>\r\n            </div>\r\n            \r\n            <div className=\"attributeSection\">\r\n                <span>Bar Attributes: </span>\r\n                {this.state.subItem.indices ? \r\n                    <div className=\"attributeGroup\">\r\n                    <AttributeSection children = {this.state.subItem.indices} title=\"Width\" app={this} def={this.state.width} callback={this.changeWidth} active={this.state.activeWidth}/>\r\n                    <AttributeSection children = {this.state.subItem.indices} title=\"Height\" app={this} def={this.state.height} callback={this.changeHeight}active={this.state.activeHeight}/>\r\n                    <AttributeSection children = {this.state.subItem.indices} title=\"Color\" app={this} def={this.state.color} callback={this.changeColor}active={this.state.activeColor}/>\r\n                    <AttributeSection children = {this.state.subItem.indices} title=\"Bivariate\" app={this} def={this.state.bivariate} callback1={this.changeBivariate1} active={this.state.activeBivariate}callback2={this.changeBivariate1}/>\r\n                    </div>\r\n                    : \r\n                    \"Loading...\"\r\n                }\r\n            </div>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nchangeWidth = (event) => {\r\n    console.log(event.target.value + \" width\")\r\n    this.setState({\r\n        width: event.target.value\r\n    })\r\n    this.props.callbackF(\"width\",event.target.value)\r\n}\r\n\r\nchangeHeight = (event) => {\r\n    this.setState({\r\n        height: event.target.value\r\n    })\r\n    this.props.callbackF(\"height\",event.target.value)\r\n}\r\n\r\nchangeColor = (event) => {\r\n    this.setState({\r\n        color: event.target.value\r\n    })\r\n    this.props.callbackF(\"color\",event.target.value)\r\n}\r\n\r\nchangeBivariate1 = (event) => {\r\n    var arr = this.state.bivariate\r\n    arr[0]=event.target.value\r\n    this.setState({\r\n        bivariate: arr\r\n    })\r\n    this.props.callbackF(\"bivariate1\",event.target.value)\r\n}\r\n\r\nchangeBivariate2 = (event) => {\r\n    var arr = this.state.bivariate\r\n    arr[1]=event.target.value\r\n    this.setState({\r\n        bivariate: arr\r\n    })\r\n    this.props.callbackF(\"bivariate2\",event.target.value)\r\n}\r\n\r\ncomponentDidUpdate(){\r\n   // console.log(this.props.cities)\r\n    //console.log(this.state)\r\n}\r\ncomponentDidMount(){\r\n    console.log(this.props.currentCity)\r\n    console.log(this.props.currentYear)\r\n    for(var i = 0; i < this.m_menu_structure.length; i++){\r\n        if(this.m_menu_structure[i].name===this.props.currentCity){\r\n           \r\n            this.setState({\r\n                subItem:this.m_menu_structure[i],\r\n                city: this.props.currentCity,\r\n                year: this.props.currentYear,\r\n                width:this.props.initWidth,\r\n            height: this.props.initHeight,\r\n            })\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\ntoggleActive = (y) => {\r\n    this.setState({\r\n        year: y\r\n    })\r\n    console.log(y)\r\n    this.props.callbackF(\"year\",y)\r\n}\r\n\r\ntoggleAttribute = (attr) => {\r\n    switch(attr){\r\n        case\"Width\":\r\n        this.setState(prevState => ({\r\n            activeWidth: !prevState.activeWidth\r\n        }));\r\n        break;\r\n        case\"Height\":\r\n        this.setState(prevState => ({\r\n            activeHeight: !prevState.activeHeight\r\n        }));\r\n        break;\r\n        case\"Color\":\r\n        this.setState(prevState => ({\r\n            activeColor: !prevState.activeColor\r\n        }));\r\n        break;\r\n        case\"Bivariate\":\r\n        \r\n        this.setState(prevState => ({\r\n            activeBivariate: !prevState.activeBivariate\r\n        }));\r\n        this.props.callbackF(\"bivToggle\",true)\r\n        break;\r\n        default:\r\n            console.log(\"Invalid attribute: @Menu.toggleAttribute  \" + attr)\r\n    }\r\n}\r\nhandleChange =(event)=>{\r\n    this.props.callbackF(\"city\",event.target.value)\r\n    for(var i = 0; i < this.m_menu_structure.length; i++){\r\n        if(this.m_menu_structure[i].name===event.target.value){\r\n            this.setState({\r\n                subItem: this.m_menu_structure[i],\r\n                city: event.target.value,\r\n                year: this.m_menu_structure[i].years[0]\r\n            })\r\n        }\r\n    }\r\n   \r\n}\r\n\r\n\r\n\r\n}\r\nconst AttributeSection = ({title, children, def, app, callback, callback1, callback2, active}) => (\r\n\r\n\r\n        <div onClick={() => app.toggleAttribute(title)} className = {`attributePanel ${active ? \"attributePanel_active\": \"\"}`}>\r\n            <div  className=\"attributeLabel\"> {title}</div>    \r\n            {title!==\"Bivariate\" ? \r\n                <select className=\"attributeDropdown\" value={def} onChange={callback}>\r\n                    {children.map(\r\n                        (child, i) =>\r\n                         <option key={\"child\"+i} value={child}>{child}</option>\r\n                    )}\r\n                </select>\r\n             \r\n            :   \r\n            <div className=\"bivariateGroup\">\r\n                <select className=\"attributeDropdown\" value={def[0]} onChange={callback1}>\r\n                    {children.map(\r\n                    (child, i) =>\r\n                     <option key={\"child\"+i} value={child}>{child}</option>\r\n                    )}\r\n                </select>\r\n                <select className=\"attributeDropdown\" value={def[1]} onChange={callback2}>\r\n                {children.map(\r\n                    (child, i) =>\r\n                    <option key={\"child\"+i} value={child}>{child}</option>\r\n                 )}\r\n                </select>\r\n            </div>\r\n\r\n            }\r\n             \r\n        </div>\r\n    \r\n)\r\n      ","export function getHighestValue(data, parameter ){\r\n    //Toan:\r\n    //  barHeight = Math.max(value * currData.json.scale[col] * feature.scale, 10)\r\n    //console.log(data)\r\n    var highest= -1\r\n    var val, i\r\n    for( i = 0; i < data.features.length; i ++){\r\n        val = parseFloat(data.features[i].properties[parameter])\r\n      //  if(isNaN(val)){\r\n       //     console.log(val)\r\n        //}\r\n        if ( val > highest) \r\n            highest =  val\r\n    }\r\n\r\n    return highest;\r\n}\r\n\r\n\r\nexport function getLowestValue(data, parameter ){\r\n    //Toan:\r\n    //  barHeight = Math.max(value * currData.json.scale[col] * feature.scale, 10)\r\n    \r\n    var lowest= 999999\r\n    var val, i\r\n    for( i = 0; i < data.features.length; i ++){\r\n        val = parseFloat(data.features[i].properties[parameter])\r\n      //  if(isNaN(val)){\r\n      //      console.log(val)\r\n     //   }\r\n        if ( val < lowest) \r\n            lowest =  val\r\n    }\r\n\r\n    return lowest == -1 ? 0 : lowest;\r\n}\r\n\r\nexport function getLongIndices(){\r\n    return [\"Population\",\r\n    \"Ethnicity-raw-count\",\r\n    \"Ethnicity-count\",\r\n    \"Ethnicity-index\",\r\n    \"Ethnicity-raw-normalized\",\r\n    \"Ethnicity-raw-norm\",\r\n    \"Ethnicity-norm\",\r\n    \"Ethnicity-norm-index\",\r\n    \"Mobility-raw-pct\",\r\n    \"Mobility-pct\",\r\n    \"Mobility-index\",\r\n    \"Generation-raw-SI\",\r\n    \"Generation-SI\",\r\n    \"Generation-index\",\r\n    \"Income-raw-SI\",\r\n    \"Income-SI\",\r\n    \"Education-raw-SI\",\r\n    \"Education-SI\",\r\n    \"Income-index\",\r\n    \"Education-index\",\r\n    \"Income-SE\",\r\n    \"Immig-category-index\",\r\n    \"Immig-category-raw-SI\",\r\n    \"Total-pop\"]\r\n}\r\n\r\nexport function getShortIndices(){\r\n    return [\"a\", \"b\",\"ba\",\"c\",\"d\",\"da\",\"db\",\"e\",\"f\",\"fa\",\"g\",\"h\",\"ha\",\"i\",\"j\",\"ja\",\"k\",\"ka\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\"]\r\n}\r\n\r\nexport function getIndicesForCity(city){\r\n    switch(city){\r\n        case \"Vancouver\":\r\n            return [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n            \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\",\"Income-SE\",\"Ethnicity-raw-norm\",\"Immig-category-raw-SI\",\t\"Immig-category-index\"\t]\r\n        case \"Melbourne\":\r\n            return [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-raw-normalized\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n            \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\"]\r\n        case \"Sydney\":\r\n            return  [\"Population\", \"Ethnicity-raw-count\",\t\"Ethnicity-index\",\t\"Ethnicity-raw-normalized\",\t\"Ethnicity-norm-index\",\t\"Mobility-raw-pct\",\t\"Mobility-index\",\t\"Generation-raw-SI\",\r\n            \"Generation-index\",\t\"Income-raw-SI\",\t\"Income-index\",\t\"Education-raw-SI\",\t\"Education-index\"]\r\n        case \"Auckland\":\r\n            return [\"Population\",\"Ethnicity-count\",\t\"Ethnicity-index\",\t\"Ethnicity-norm\",\t\"Ethnicity-norm-index\",\t\"Mobility-pct\",\t\"Mobility-index\",\t\"Generation-SI\",\t\"Generation-index\",\t\"Income-SI\",\t\"Income-index\",\r\n            \"Education-SI\",\t\"Education-index\"]\r\n        default:\r\n            console.log(\"Ooops this city has no indices: \" + city)\r\n    }\r\n}\r\n\r\nexport function getNewRangeValue(x, oldMin,oldMax,newMin,newMax){\r\n    \r\n    if(x<0 || isNaN(x) || x==undefined) \r\n        return 0\r\n\r\n    if (oldMin === oldMax) {\r\n        console.log(\"0 input range\")\r\n    }\r\n    if( newMin === newMax) {\r\n       console.log(\"0 output range\")\r\n    }\r\n\r\n   \r\n    if(oldMin===-1){\r\n       oldMin=oldMin+1\r\n       oldMax=oldMax+1\r\n       x=x+1\r\n    }\r\n    var portion = (x-oldMin)*(newMax-newMin)/(oldMax-oldMin)\r\n    var result = portion + newMin\r\n    \r\n    if(isNaN(result) || result===undefined){\r\n        return 0;\r\n    }\r\n    return result\r\n}","\nimport React, { Component } from 'react';\nimport './App.css';\nimport MapFunctions from './MapFunctions';\n\n\n//data\nimport centerData96Auckland from './data/Auckland/Auck1996___min.json'\nimport centerData13Auckland from './data/Auckland/Auck2013___min.json'\n\nimport centerData06Melb from './data/Melbourne/Melb06_____min.json'\nimport centerData11Melb from './data/Melbourne/Melb11_____min.json'\nimport centerData16Melb from './data/Melbourne/Melb16_____min.json'\n\n\nimport centerData2001Syd from './data/Sydney/Syd01___m__min.json'\nimport centerData2006Syd from './data/Sydney/Syd06___m__min.json'\nimport centerData2011Syd from './data/Sydney/Syd11___m__min.json'\nimport centerData2016Syd from './data/Sydney/Syd16___m__min.json'\n\nimport centerData96Vanc from './data/Vancouver/Vanc96_____min.json'\nimport centerData06Vanc from './data/Vancouver/Vanc06_____min.json'\nimport centerData16Vanc from './data/Vancouver/Vanc16_____min.json'\n\nimport bivariateImage from './images/bivariate_scheme1.png'\nimport colorImage from './images/color_sequential.png'\nimport Menu  from './Menu';\nimport * as turf from '@turf/turf'\n\nimport * as helper from './Helpers.js'\n\nexport default class App extends Component { \n  \n  m_datasets = [ \n    centerData96Auckland,\n    centerData13Auckland,\n    centerData06Melb,\n    centerData11Melb,\n    centerData16Melb,\n    centerData2001Syd,\n    centerData2006Syd,\n    centerData2011Syd,\n    centerData2016Syd,\n    centerData96Vanc,\n    centerData06Vanc,\n    centerData16Vanc\n  ]\n\n\n\n  m_biVariatecolors = {\n    \"00\": \"#e8e8e8\",\n    \"01\": \"#b0d5df\",\n    \"02\": \"#64acbe\",\n    \"10\": \"#e4acac\",\n    \"11\": \"#ad9ea5\",\n    \"12\": \"#627f8c\",\n    \"20\": \"#c85a5a\",\n    \"21\": \"#985356\",\n    \"22\": \"#574249\"\n}\n\n\nm_colorsSequential = [\n   '#FDE726',\n  '#BDDF27',\n'#7AD151',\n'#45BF70',\n'#23A884',\n'#22918C',\n'#2B788E',\n'#365F8D',\n'#414487',\n'#482475',\n'#440154'\n]\n  m_selectorStructure = {\n    \"Melbourne\":{\n      \"2006\": centerData06Melb,\n      \"2011\":centerData11Melb,\n      \"2016\":centerData16Melb\n    },\n    \"Vancouver\":{\n      \"1996\": centerData96Vanc,\n      \"2006\":centerData06Vanc,\n      \"2016\":centerData16Vanc\n    },\n    \"Auckland\":{\n      \"1996\": centerData96Auckland,\n      \"2013\":centerData13Auckland,\n\n    },\n    \"Sydney\":{\n      \"2001\":centerData2001Syd,\n      \"2006\": centerData2006Syd,\n      \"2011\":centerData2011Syd,\n      \"2016\":centerData2016Syd\n    }\n  }\n\n\n  m_boundingValuesColor = [0,8800]\n  state = {\n    data: [],\n    city: \"Vancouver\",\n    year: \"2006\",\n    heightParameter: \"Population\",\n    widthParameter: \"Ethnicity-index\",\n    colorParameter: \"Ethnicity-index\",\n    bivariateParameter1: \"Ethnicity-index\",\n    bivariateParameter2: \"Income-index\",\n    showBivariate: false,\n    showColor: true,\n    boundingValuesHeight:[100, 8515],\n    boundingValuesWidth: [50,60],\n    boundingValuesBivariate1: [50,60],\n    boundingValuesBivariate2: [50,60],\n    colorChanged: false\n  }\n\n  componentDidMount(){\n   // d3.csv(vancData).then(this.updateStateData);\n  \n    //convert points in the datasets to polygons\n    for(var i = 0; i < this.m_datasets.length; i++){\n      this.m_datasets[i] = this.prepDatasets(this.m_datasets[i], 0.3)\n    }\n    \n    //calculate the highes value for each parameter for each city, so in the vis we can scale the bars accordingly.\n    for(const city in this.m_selectorStructure){\n      var highestValues=[]\n      var lowestValues=[]\n      var high,index, low\n\n     \n      for(const year in this.m_selectorStructure[city]){\n   //     console.log(\"City: \" + city +  \" Year:  \" + year)\n        for(var j =0; j < helper.getIndicesForCity(city).length; j++){\n          index = helper.getIndicesForCity(city)[j]\n     \n          high = helper.getHighestValue(this.m_selectorStructure[city][year],index)\n          low = helper.getLowestValue(this.m_selectorStructure[city][year],index)\n          if(typeof(high)=== 'number')\n            highestValues[index] = (highestValues[index]===undefined || highestValues[index] < high) ? high : highestValues[index]\n\n          if(typeof(low)==='number')\n            lowestValues[index] = (lowestValues[index]===undefined || lowestValues[index] > low) ? low : lowestValues[index]\n\n        }\n      }\n      this.m_selectorStructure[city].highestValues = highestValues;\n      this.m_selectorStructure[city].lowestValues = lowestValues\n      this.updateColors(city,this.state.colorParameter,[this.m_selectorStructure[city].highestValues[this.state.colorParameter],this.m_selectorStructure[city].lowestValues[this.state.colorParameter]])\n    }\n    \n    console.log(this.m_selectorStructure)\n    //initial dataset \n    this.setState({\n      data:centerData06Vanc\n     })\n  }\n\n  // preps the datasets for usage. Creates circle polygons to extrude as columns, initially all with the same width, and replaces the shortened indices with their proper ones for labelling etc.\n  prepDatasets = (dataset, width) => {\n    console.log(\"prep Datasets\")\n    var features = dataset.features\n    var circlepoly, newGeometry, i, j\n    for( i = 0; i < features.length; i ++){\n  \n      circlepoly = turf.circle([features[i].geometry.coordinates[0],features[i].geometry.coordinates[1]], width, { steps: 12 })\n      newGeometry = circlepoly.geometry\n      features[i].centerCircle = features[i].geometry\n      features[i].geometry = newGeometry\n      var propertyKeys = Object.keys(features[i].properties)\n\n      for(j = 0; j < propertyKeys.length; j++){\n    \n        if(helper.getShortIndices().indexOf(propertyKeys[j]) >= 0) {\n          //console.log(propertyKeys[j])\n          features[i].properties[helper.getLongIndices()[helper.getShortIndices().indexOf(propertyKeys[j])]] = features[i].properties[propertyKeys[j]]\n          delete features[i].properties[propertyKeys[j]]\n        }\n      }\n    }\n    return dataset\n  }\n\n  renameKey = (object,key,newKey) => {\n   //console.log(key + \" -- \" + newKey)\n    if(newKey!== undefined){\n      var clonedObj = clone(object);\n      var targetKey = clonedObj[key];\n      delete clonedObj[key];\n      clonedObj[newKey] = targetKey;\n    return clonedObj;\n    } else {\n      return object\n    }\n  }\n\n\n  getBoundingValues = (city,parameter) => {\n    var highestValueArray = this.m_selectorStructure[city].highestValues\n    var lowestValueArray =this.m_selectorStructure[city].lowestValues\n    //console.log(parameter+ \"  :  \" + lowestValueArray[parameter] + \"  -  \"  + highestValueArray[parameter])\n    return [lowestValueArray[parameter],highestValueArray[parameter]]\n  }\n  menuCallback= (label, content) => {\n    //console.log(label)\n    //console.log(content)\n    if(label===\"city\"){\n      console.log(this.m_selectorStructure[content][Object.keys(this.m_selectorStructure[content])[0]])\n      this.setState({\n        city:content,\n        year: Object.keys(this.m_selectorStructure[content])[0], //take the first available year of the new city\n        data: this.m_selectorStructure[content][Object.keys(this.m_selectorStructure[content])[0]]\n      })\n    } else if(label===\"year\"){\n      this.setState({\n        year: content,\n        data: this.m_selectorStructure[this.state.city][content]\n      })\n    } else if(label===\"bivToggle\"){\n      this.setState(prevState => ({\n        showBivariate: !prevState.showBivariate\n      }))\n    } \n    else if(label===\"colorToggle\"){\n      this.setState(prevState => ({\n        showColor: !prevState.showColor\n      }))\n    } \n    else if (label===\"height\"){\n      this.setState({\n        heightParameter: content,\n        boundingValuesHeight: this.getBoundingValues(this.state.city,content)\n      })\n    }\n    else if (label===\"width\"){\n      this.setState({\n        //TODO: calculate the new data set here as width is special.\n        widthParameter: content,\n        boundingValuesWidth: this.getBoundingValues(this.state.city,content)\n      })\n    }\n    else if (label===\"color\"){\n      console.log(\"color changed\")\n      this.m_boundingValuesColor =  this.getBoundingValues(this.state.city,content)\n      this.updateColors(this.state.city,content)\n      this.setState(prevState => ({\n        data: this.m_selectorStructure[this.state.city][this.state.year],\n        colorChanged:!prevState.colorChanged\n      }))\n    }\n    else if (label===\"bivariate1\"){\n      this.setState({\n        bivariateParameter1: content,\n        boundingValuesBivariate1: this.getBoundingValues(this.state.city,content)\n      })\n    }\n    else if (label===\"bivariate2\"){\n      this.setState({\n        bivariateParameter2: content,\n        boundingValuesBivariate2: this.getBoundingValues(this.state.city,content)\n      })\n    }\n  }\n\n\n //updates the colour information in the data for each dataset in a city\n  updateColors(city, param, bounds){\n    var test =Array.apply(null, Array(this.m_colorsSequential.length)).map(function (x, i) { return 0; })\n    //console.log(test.length)\n    var a, b\n      if(bounds){\n        a = bounds[0]\n        b=bounds[1]\n      } else{\n        a =this.m_boundingValuesColor[0]\n        b =this.m_boundingValuesColor[1]\n      }\n      for(const year in this.m_selectorStructure[city]){\n       \n      //  console.log(test)\n        if(year.length<=4){\n          test =Array.apply(null, Array(this.m_colorsSequential.length)).map(function (x, i) { return 0; })\n          var data = this.m_selectorStructure[city][year]\n       //   console.log(data)\n          for(var i =0; i < data.features.length; i++){\n          //var val = Math.floor(((data.features[i].properties[this.props.colorParam] / this.props.highestValueColor) * this.m_colorsSequential.length) +1)\n       \n            var val = helper.getNewRangeValue(data.features[i].properties[param],a,b,0,10)\n            //console.log(val)\n            val = Math.floor(val)\n            test[val]+=1\n            data.features[i].properties[\"color\"] = this.m_colorsSequential[val]\n           \n          }\n        this.m_selectorStructure[city][year] = data\n      //  console.log(test)\n        }\n      }\n}\n  render() {\n    \n    return( \n\n    <div className=\"App\">\n      <div className=\"Container\">\n      {this.state.showBivariate ? <div id=\"bivariateImage\"><img id=\"bivImg\" src={bivariateImage} alt=\"bivariateScheme\" /></div> : \"\"}\n      {this.state.showColor ? <div id=\"colorImage\"><img id=\"colImg\" src={colorImage} alt=\"colours\" /></div> : \"\"}\n      <Menu callbackF={this.menuCallback} currentCity={this.state.city} currentYear={this.state.year} initWidth={this.state.widthParameter} initHeight={this.state.heightParameter}/>\n      {<MapFunctions data={this.state.data} \n      year={this.state.year} \n      city={this.state.city}\n       heightParam={this.state.heightParameter} \n       widthParam = {this.state.widthParameter}\n       bivariateParam1 = {this.state.bivariateParameter1}\n       bivariateParam2 = {this.state.bivariateParameter2}\n       boundingValuesHeight={this.state.boundingValuesHeight} \n       boundingValuesWidth={this.state.boundingValuesWidth}\n       boundingValuesBivariate1 = {this.state.boundingValuesBivariate1}\n       boundingValuesBivariate2 = {this.state.boundingValuesBivariate2}\n       colorChanged={this.state.colorChanged}\n    />}\n     \n      \n      </div>\n   \n    </div>\n    )\n  }\n}\n\nconst clone = (obj) => Object.assign({}, obj);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}